!function(t){var e={};function s(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(o,i,function(e){return t[e]}.bind(null,i));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);var o=(t,e,s)=>{let o=[],i=[];return{getID:()=>t,getType:()=>e,getSize:()=>s,getPositions:()=>o,addPosition:t=>{o.push(t)},overridePositions:t=>{const e=o[0];console.log(t),o=[e,...t],console.log({pivot:e,positions:o,newPositions:t})},resetPositions:()=>{const t=[...o];return o=[],t},removePositions:t=>{for(let e=0;e<t.length;e+=1)o.splice(t[e].indexOf(position))},hit:t=>{i.push(t)},isSunk:()=>{o.length,i.length}}},i=(()=>{let t=[],e=[];return{getPlayerPositions:()=>t,addPlayerPositions:e=>{e.forEach(e=>{t.push(e)})},addPlayerShip:t=>{e.push(t)},getShip:t=>{for(let s=0;s<e.length;s+=1)if(e[s].getID()===t)return e[s]},addShipPositions:(t,s)=>{let o;return e.forEach(e=>{e.getID()===t&&(s.forEach(t=>e.addPosition(t)),o=e.getPositions())}),o},removePlayerPositions:e=>{e.forEach(e=>{const s=t.indexOf(e);t.splice(s,1)})},removeShipPositions:(t,s)=>{for(let o=0;o<e.length;o+=1)if(e[o].getID()===t){e[o].removePositions(s);break}},resetShipPositions:t=>{let s;return e.forEach(e=>{e.getID()===t&&(s=e.resetPositions())}),s},hasPlayerPosition:e=>t.includes(e),removeLastPlayerPosition:()=>{t.pop()},hasPlayerPositions:e=>{let s=0;return e.forEach(e=>{t.includes(e)&&(console.log("Position "+e+" is already in the positions array"),s+=1)}),s>0}}})(),r=(()=>{let t="";const e=e=>{e.target.classList.add("drag-start"),e.dataTransfer.setData("text",e.target.id);const s=i.resetShipPositions(e.target.id);s&&i.removePlayerPositions(s),(e=>{t=e})(e.target.id),setTimeout(()=>e.target.classList.add("invisible"),0)},s=t=>{t.target.classList.remove("invisible"),t.target.classList.remove("drag-start")},o=t=>{const e=i.getShip(t.target.id),s=parseInt(e.getPositions()[0].match(/\d+/)[0]),o=e.getPositions()[0].match(/[a-j]/)[0],n=[...e.getPositions()].splice(1),a=t.target.className.match(/horizontal|vertical/)[0],l="abcdefghij".split("");let c=[];if(e.getPositions().length>1){for(let t=1;t<e.getPositions().length;t+=1){let e="";"vertical"===a?e=s+"-"+l[l.indexOf(o)+t]:"horizontal"===a&&(e=s+t+"-"+o),c.push(e)}e.overridePositions(c)}i.hasPlayerPositions(c)||(i.removePlayerPositions(n),i.addPlayerPositions(c),console.log("Player positions updated: "+i.getPlayerPositions()),r(t))},r=t=>{t.target.classList.forEach(e=>{if(/^horizontal/.test(e)){t.target.classList.remove(e);const s="vertical"+e.substring(10);t.target.classList.add(s)}else if(/^vertical/.test(e)){t.target.classList.remove(e);const s="horizontal"+e.substring(8);t.target.classList.add(s)}else;}),t.target.classList.contains("horizontal")?(t.target.classList.remove("horizontal"),t.target.classList.add("vertical")):t.target.classList.contains("vertical")&&(t.target.classList.remove("vertical"),t.target.classList.add("horizontal"))};return{init:()=>{const t=document.querySelectorAll('*[class^="ship"]');for(const i of t)i.addEventListener("dragstart",e,!1),i.addEventListener("dragend",s,!1),i.addEventListener("click",o,!1)},getDragged:()=>t}})();const n=t=>{t.preventDefault()},a=t=>{t.preventDefault()},l=t=>{t.preventDefault()},c=t=>t.match(/battleship/)?4:t.match(/cruiser/)?3:t.match(/destroyer/)?2:t.match(/submarine/)?1:void 0,d=(t,e,s)=>{console.log("********************"),console.log("Position Received "+t);const o=parseInt(t.match(/\d+/)[0]),i=t.substring(5).match(/[a-j]/)[0],r=e.match(/horizontal|vertical/)[0],n="abcdefghij".split("");let a=[];if(s>1)for(let t=1;t<s;t+=1){let e="";"horizontal"===r?e=o+"-"+n[n.indexOf(i)+t]:"vertical"===r&&(e=o+t+"-"+i),a.push(e)}return a},g=t=>{console.log("On Drop...");const e=t.dataTransfer.getData("text"),s=document.getElementById(e),o=i.resetShipPositions(e);o&&i.removePlayerPositions(o),t.target.appendChild(s),((t,e,s)=>{console.log("Setting Positions");const o=t.id.substring(5),r=c(s),n=[o,...d(t.id,e.className,r)],a=i.addShipPositions(s,n);a&&i.addPlayerPositions(a),console.log("Player positions updated: "+i.getPlayerPositions())})(t.target,s,e),s.className=(t=>{const e=t.split(" ");return e.splice(1,0,"dropped"),e.join(" ")})(s.className)},u=t=>{t.preventDefault(),(t=>{const e=r.getDragged(),s=document.getElementById(e),o=d(t.target.id,s.className,c(e)),n=[t.target.id.substring(5),...o];let a=!1;return n.forEach(t=>{t.match(/undefined/)&&(a=!a)}),console.log("Evaluate this positions: "+n),i.hasPlayerPositions(n)||a})(t)||/^cell/.test(t.target.id)&&g(t)};var h=()=>{r.init(),(()=>{const t=document.querySelectorAll(".cell");for(const e of t)e.addEventListener("dragover",n,!1),e.addEventListener("dragenter",a,!1),e.addEventListener("dragleave",l,!1),e.addEventListener("drop",u,!1)})()};const f=(t,e,s)=>t>=0&&t<s-1&&0===e?"first-border":t===s-1&&0===e?"bottom-right-border":t===s-1&&e>0?"last-row-inner-border":"inner-border";var p=()=>{(()=>{const t=document.getElementById("board");t.innerHTML="";const e=["a","b","c","d","e","f","g","h","i","j"];for(let s=0;s<10;s+=1){let o=`<div id="cells-${s+1}" class="cells">`;for(let t=0;t<10;t+=1)o+=`<div id="cell-${s+1}-${e[t]}" class="cell ${f(s,t,10)}"></div>`;o+="</div>",t.innerHTML+=o}})()};(()=>{const t=[{size:4,quantity:1,name:"battleship"},{size:3,quantity:2,name:"cruiser"},{size:2,quantity:3,name:"destroyer"},{size:1,quantity:4,name:"submarine"}],e=document.getElementById("ships");let s="";t.forEach(t=>{const e=t.quantity;for(let r=0;r<e;r+=1){const e=o(t.name+"-"+r,t.name,t.size);i.addPlayerShip(e),s+=`<div id="${t.name}-${r}" class="ship-${t.name}-${r} horizontal-${t.name}" draggable="true"></div>`}}),e.innerHTML=s})(),p(),h()}]);